# 조명 및 표면 렌더링

## 조명 모델의 개념

### 1. 조명 모델의 개념

#### 전역 조명 모델(global illumination model)

- 물체에 직접 도달하는 빛뿐만 아니라 다른 물체에 반사되어 도달하는 빛까지 고려한 모델
- 정교한 조명 효과를 표현할 수 있음
- 물체에 반복적으로 반사되는 빛을 추적하기 위해 많은 계산이 필요함

#### 지역 조명 모델(local illumination model)

- 광원으로부터 물체에 직접 도달하는 빛만 계산
- 전역 조명 모델에 비해 빠른 처리가 가능

### 2.광원

#### 주변광(ambient)

- 주변의 다양한 물체에 반사되어 전달되는 빛을 근사화한 광원
- 전역 조명 모델이 아닌 경우 모든 반사되는 빛을 계산하는게 아닌 적당히 근사화한 빛을 모든 면에 전달해줌
- 여러 방향으로부터 빛지 전달되며, 반사가 반복적으로 이루어짐
- 모든 면에 균일하게 전달되는 빛으로 근사화
- 세 가지 색 성분으로 표현된 광량 I_amb로 정의됨
- 주변광만 고려한 경우 동일한 색을 갖는 면은 밝기 차이가 없어 입체감을 느낄 수 없음


#### 점광원(point light)

- 한 점에서 하나의 색을 갖는 빛을 방사하는 광원
- 위치성 광원(positional light)
- 모든 방향으로 빛을 방사하는 전방향성 광원(ommi light)
- 위치와 광원과의 거리가 중요(거리에 따른 빛의 감쇠)
- 명암의 대비가 크게 나타남 -> 주변광을 추가하여 지나치게 높은 명암 대비가 일어나는 것을 완화함
- 점광원의 정의: 광원의 위치와 빛의 색
- l_p(p0) = [l_pr, l_pg, l_pb]

<b>거리에 따른 빛의 감쇠</b>

- 이론적으로 점 광원에 의한 조도는 거리의 제곱에 반비례(구의 표면적 = 4 * pr * r^2)
- 빛의 세기가 급격히 약화되는 문제를 완화하기 위해 거리 광도 감쇠 함수를 사용
- f_DistAttt(d) = 1/(a_0 + a_1 * d + a_2 * d^2)
- 상수항은 기본 밝기를 책임짐

#### 방향성 광원(directional light)

- 태양과 같이 물체에서 매우 멀리 떨어진 곳에 존재하는 광원
- 평행한 방향으로 전달되는 빛으로 근사화
- 광원의 위치가 아닌 빛이 전달되는 방향으로 광원을 정의
- 거리에 따른 광량 감쇠를 적용하지 않음

#### 스포트라이트(spotlight)

- 제한된 각도로 빛을 내는 광원
- 단순한 정의: 점광원의 빛을 지정된 방향을 기준으로 일정한 발산각 θ 이내로 제한
- v_s dot v_obj >= cosθ_s, 0 <= a <= θ_s
- 보다 현실감 있는 정의를 위해 각 광도 감쇠 적용 -> cos^e 에서 e를 조절함으로 감쇠 정도를 결정

### 3. 표면 반사

#### 난반사(diffuse)

- 거칠고 매끄럽지 못한 표면에서 발생
- 이상적인 난반사: 입사된 빛이 모든 방향으로 흩어짐
    - 표면의 밝기는 관찰자가 보는 각도에 관계없이 동일
    - 람베르트 반사
- 난반사에 의해 관찰되는 밝기 I_diff
- 주변광에 의한 난반사: 주변광(K_d) * 난반사 계수(I_amb)
- 빛의 방향과 노말벡터의 cos으로 값을 계산. 광량 = I_inc * cosθ

#### 정반사(specular)

- 매끄러운 표면에서 밝게 빛나는 반사광
- 완전한 정반사: θ_I = θ+R 인 R방향으로만 반사가 일어남
- 완전한 정반사가 아닌 경우: 시점 방향 V의 반사광은 R과 이루는 각도의 파이가 커짐에 따라 약해짐
- 퐁 반사 모델(Phong reflection model)의 정반사
- n_s : 광택계수
- cos^ns 파이

#### 퐁 반사 모델

- 주변광 + 각각의 광원에 대한 난반사 및 정반사 요소
- 주변광 + 확산광(난반사) + 경면광(정반사)

## 다각형 음영법

### 1. 균일 음영법

하나의 다각형 표면을 동일한 색으로 채움

- 경계 부분이 두드러지고 마하밴드가 크게 눈에 띔

### 2. 구로 음영법

- 다각형의 꼭지점 색을 구한 후 이를 보간하여 다각형 내부 픽셀을 결정하는 음영법
- 꼭짓점 색의 결정
    - 꼭짓점을 공유하는 다각형의 표면 법선벡터 평균을 계산
    - 조명 모델을 적용하여 꼭짓점의 색을 결정
- 다각형 내부 색 결정
    - 모든 꼭짓점 색을 결정한 후 쌍선형 보간을 통해 각각 내부 점들의 색을 결정
- 균일 음영법에 비해 자연스럽게 변화하는 곡면 표현 가능
- 마하밴드에 의한 시각적 품질 저하
- 정반사에 의한 하이라이트 오류 문제

### 3. 퐁 음영법

- 퐁 음영법에 다각형 내부 색의 결정 방법
- 꼭짓점들에서의 법선 벡터를 쌍선형 보간을 하여 다각형 내부 픽셀에서의 법선 벡터를 구함
- 계산된 법선 벡터를 이용하여 퐁 반사 모델에 따라 픽셀 색 결정
- 구로 음영법에 비해 계산량이 많지만 보다 정확한 색을 계산할 수 있음
